---
- name: Windows Server Simple Playbook Demo
  hosts: "{{ target_host_name }}*"

  tasks:
  # Set Computer Hostname, we get name variable from inventory host variable
  - name: set windows hostname
    win_hostname:
      name: "{{ name }}"
    register: hostname_change_result
  - name: reboot if required
    win_reboot:
    when: hostname_change_result.reboot_required
  - name: wait for windows connection
    wait_for_connection:
    when: hostname_change_result.reboot_required

  # Setting up dummy registry entries
  - name: Create registry path MyCompanySoftware
    win_regedit:
      path: HKCU:\Software\MyCompanySoftware  
  - name: Add or update registry path MyCompanySoftware, with entry 'name'
    win_regedit:
      path: HKCU:\Software\MyCompanySoftware
      name: name
      data: felizkarnadi
  - name: Add or update registry path MyCompanySoftware, with entry 'employeeid'
    win_regedit:
      path: HKCU:\Software\MyCompanySoftware
      name: employeeid
      data: 113355

  # Install MSI for 7Zip
  - name: create installer directory
    win_file:
      path: C:\installer
      state: directory
  - name: download the 7-Zip package
    win_get_url:
      url: http://www.7-zip.org/a/7z1701-x64.msi
      dest: C:\installer\7z.msi
  - name: ensure 7-Zip is installed via win_package
    win_package:
      path: C:\installer\7z.msi
      state: present

  # Install/Update Firefox using Chocolatey.org package manager
  # Chocolatey is going to be auto-installed if not present
  - name: install Firefox using Chocolatey.org
    win_chocolatey:
      name: firefox
      state: latest
...